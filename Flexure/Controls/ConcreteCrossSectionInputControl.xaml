<UserControl x:Class="ACI318_19Library.ConcreteCrossSectionInputControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:ACI318_19Library"
             >
    <UserControl.Resources>
        <ControlTemplate x:Key="RowValidationTemplate">
            <DockPanel LastChildFill="True">
                <TextBlock Foreground="Red" Margin="2"
                   Text="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow},
                                  Path=(Validation.Errors)[0].ErrorContent}"/>
                <AdornedElementPlaceholder />
            </DockPanel>
        </ControlTemplate>
    </UserControl.Resources>
    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Inputs -->
            <RowDefinition Height="Auto"/>
            <!-- Tension Rebars -->
            <RowDefinition Height="Auto"/>
            <!-- Compression Rebars -->
            <RowDefinition Height="*"/>
            <!-- filler -->
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!-- Inputs Grid -->
        <StackPanel Grid.Column="0">

            <Grid Grid.Row="0" Margin="0,0,0,10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Width -->
                <TextBlock Text="Width, b (in):" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center"/>
                <local:NumericUpDown x:Name="WidthBox" Grid.Row="0" Grid.Column="1"
                         Value="{Binding Width, UpdateSourceTrigger=PropertyChanged}"
                         Minimum="1" Maximum="36" Step="1.0"
                                     ValueChanged="NumericUpDown_ValueChanged"/>

                <!-- Depth -->
                <TextBlock Text="Height, h (in):" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center"/>
                <local:NumericUpDown x:Name="DepthBox" Grid.Row="1" Grid.Column="1"
                         Value="{Binding Height, UpdateSourceTrigger=PropertyChanged}"
                         Minimum="4" Maximum="60" Step="1.0"
                                     ValueChanged="NumericUpDown_ValueChanged"/>

                <!-- Tension Cover -->
                <TextBlock Text="Tension Cover (in):" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center"/>
                <local:NumericUpDown x:Name="TensionCoverBox" Grid.Row="2" Grid.Column="1"
                         Value="{Binding TensionCover, UpdateSourceTrigger=PropertyChanged}"
                         Minimum="1.5" Maximum="6" Step="0.25" ValueChanged="NumericUpDown_ValueChanged"/>

                <!-- Compression Cover -->
                <TextBlock Text="Compression Cover (in):" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center"/>
                <local:NumericUpDown x:Name="CompressionCoverBox" Grid.Row="3" Grid.Column="1"
                         Value="{Binding CompressionCover, UpdateSourceTrigger=PropertyChanged}"
                         Minimum="1.5" Maximum="6" Step="0.25" ValueChanged="NumericUpDown_ValueChanged"/>

                <!-- Side Cover -->
                <TextBlock Text="Side Cover (in):" Grid.Row="4" Grid.Column="0" VerticalAlignment="Center"/>
                <local:NumericUpDown x:Name="SideCoverBox" Grid.Row="4" Grid.Column="1"
                         Value="{Binding SideCover, UpdateSourceTrigger=PropertyChanged}"
                         Minimum="1.5" Maximum="6" Step="0.25" ValueChanged="NumericUpDown_ValueChanged"/>

                <!-- Clear Spacing -->
                <TextBlock Text="Clear Spacing (in):" Grid.Row="5" Grid.Column="0" VerticalAlignment="Center"/>
                <local:NumericUpDown x:Name="ClearSpacingBox" Grid.Row="5" Grid.Column="1"
                         Value="{Binding ClearSpacing, UpdateSourceTrigger=PropertyChanged}"
                         Minimum="1.5" Maximum="6" Step="0.25" ValueChanged="NumericUpDown_ValueChanged"/>

                <!-- f'c -->
                <TextBlock Text="f'c (ksi):" Grid.Row="6" Grid.Column="0" VerticalAlignment="Center"/>
                <local:NumericUpDown x:Name="FckBox" Grid.Row="6" Grid.Column="1"
                         Value="{Binding Fck_psi, UpdateSourceTrigger=PropertyChanged}"
                         Minimum="2000" Maximum="10000" Step="1000" ValueChanged="NumericUpDown_ValueChanged"/>

                <!-- Fy -->
                <TextBlock Text="Fy (ksi):" Grid.Row="7" Grid.Column="0" VerticalAlignment="Center"/>
                <local:NumericUpDown x:Name="FyBox" Grid.Row="7" Grid.Column="1"
                         Value="{Binding Fy_psi, UpdateSourceTrigger=PropertyChanged}"
                         Minimum="40000" Maximum="80000" Step="5000" ValueChanged="NumericUpDown_ValueChanged"/>
            </Grid>

            <!-- Tension Rebars -->
            <Expander Grid.Row="1" Header="Tension Rebars" IsExpanded="True" Margin="0,8,0,0">
                <StackPanel>
                    <DataGrid x:Name="TensionDataGrid"
                              ItemsSource="{Binding TensionRebars}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              MinHeight="100"
                              RowValidationErrorTemplate="{StaticResource RowValidationTemplate}">
                        <DataGrid.RowValidationRules>
                            <local:CrossSectionRowValidationRule ValidationStep="UpdatedValue" />
                        </DataGrid.RowValidationRules>
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Bar Size" Binding="{Binding BarSize}" Width="75"/>
                            <DataGridTextColumn Header="Count" Binding="{Binding Qty}" Width="75"/>
                            <DataGridTextColumn Header="Depth (in)" Binding="{Binding DepthFromTop}" Width="75"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                        <Button Content="Add" Width="50" Click="BtnAddTension_Click"/>
                        <Button Content="Remove" Width="60" Margin="4,0,0,0" Click="BtnRemoveTension_Click"/>
                    </StackPanel>
                </StackPanel>
            </Expander>

            <!-- Compression Rebars -->
            <Expander Grid.Row="2" Header="Compression Rebars" IsExpanded="True" Margin="0,8,0,0">
                <StackPanel>
                    <DataGrid x:Name="CompressionDataGrid"
                              ItemsSource="{Binding CompressionRebars}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              MinHeight="100"
                              RowValidationErrorTemplate="{StaticResource RowValidationTemplate}">
                        <DataGrid.RowValidationRules>
                            <local:CrossSectionRowValidationRule ValidationStep="UpdatedValue" />
                        </DataGrid.RowValidationRules>
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Bar Size" Binding="{Binding BarSize}" Width="75"/>
                            <DataGridTextColumn Header="Count" Binding="{Binding Qty}" Width="75"/>
                            <DataGridTextColumn Header="Depth (in)" Binding="{Binding DepthFromTop}" Width="75"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                        <Button Content="Add" Width="50" Click="BtnAddComp_Click"/>
                        <Button Content="Remove" Width="60" Margin="4,0,0,0" Click="BtnRemoveComp_Click"/>
                    </StackPanel>
                </StackPanel>
            </Expander>


            <!-- Stirrup Rebars -->
            <Expander Grid.Row="3" Header="Stirrups" IsExpanded="True" Margin="0,8,0,0">
                <StackPanel>
                    <DataGrid x:Name="StirrupDataGrid"
                              ItemsSource="{Binding StirrupRebars}"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              MinHeight="100"
                              RowValidationErrorTemplate="{StaticResource RowValidationTemplate}">
                        <DataGrid.RowValidationRules>
                            <local:CrossSectionRowValidationRule ValidationStep="UpdatedValue" />
                        </DataGrid.RowValidationRules>
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Bar Size" Binding="{Binding BarSize}" Width="75"/>
                            <DataGridTextColumn Header="Legs" Binding="{Binding NumShearLegs}" Width="75"/>
                            <DataGridTextColumn Header="Spacing, S (in)" Binding="{Binding Spacing}" Width="125"/>
                            <DataGridTextColumn Header="Start (ft)" Binding="{Binding StartPos}" Width="75"/>
                            <DataGridTextColumn Header="End (ft)" Binding="{Binding EndPos}" Width="75"/>
                            <DataGridTextColumn Header="Av / S (sq.in./in)" Binding="{Binding Av_over_S}" Width="75"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                        <Button Content="Add" Width="50" Click="BtnAddStirrups_Click"/>
                        <Button Content="Remove" Width="60" Margin="4,0,0,0" Click="BtnRemoveStirrups_Click"/>
                    </StackPanel>
                </StackPanel>
            </Expander>
        </StackPanel>
        <!-- Scrollable content -->
        <StackPanel  Grid.Column="1">
            <!--<Canvas x:Name="cnvCrossSection" Height="200" Width="200" HorizontalAlignment="Left" Background="White"/>-->
            <StackPanel Orientation="Horizontal">
                <StackPanel x:Name="spResult"/>
                <StackPanel x:Name="spShearResult"/>
            </StackPanel>
        </StackPanel>
    </Grid>
</UserControl>
